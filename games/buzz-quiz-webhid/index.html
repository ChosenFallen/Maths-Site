<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
        <title>Buzz Quiz WebHID - Maths Games</title>
        <link rel="stylesheet" href="../../css/style.css" />
        <link rel="stylesheet" href="game.css" />
    </head>
    <body>
        <div class="container">
            <h1>üî¥üîµ Buzz Quiz (WebHID Experimental)</h1>
            <p class="instructions" style="background: #fff3e0; padding: 15px; border-radius: 10px; border-left: 4px solid #ff9800;">
                ‚ö†Ô∏è <strong>Experimental Version:</strong> This version uses WebHID API to attempt LED control.
                Requires Chrome/Edge browser. LED control is experimental and may not work.
            </p>

            <!-- Setup Screen -->
            <div id="setup-screen">
                <!-- Controller Status -->
                <div class="controller-status">
                    <h3>Controllers Detected</h3>
                    <div id="controller-count" class="controller-count">
                        Checking for controllers...
                    </div>
                    <p class="hint">Connect controllers and press any button to detect them</p>
                </div>

                <!-- Player Ready Status -->
                <div id="player-ready-section" class="player-ready-section hidden">
                    <h3>Player Ready Status</h3>
                    <p class="hint">Press your red buzzer button to mark yourself as ready!</p>
                    <div id="player-ready-list" class="player-ready-list">
                        <!-- Player ready indicators generated by JS -->
                    </div>
                </div>

                <!-- Game Mode Selection -->
                <div class="menu-section">
                    <h3>Game Mode</h3>
                    <div class="options-grid">
                        <button class="option-btn active" data-mode="buzzer">
                            <div class="mode-title">üî¥ Buzzer Race</div>
                            <div class="mode-desc">First to buzz in answers</div>
                        </button>
                        <button class="option-btn" data-mode="all-answer">
                            <div class="mode-title">üéØ All Answer</div>
                            <div class="mode-desc">Everyone answers together</div>
                        </button>
                    </div>
                </div>

                <!-- Difficulty Selection -->
                <div class="menu-section">
                    <h3>Difficulty</h3>
                    <div class="options-grid">
                        <button class="option-btn" data-difficulty="easy">Easy</button>
                        <button class="option-btn active" data-difficulty="normal">Normal</button>
                        <button class="option-btn" data-difficulty="hard">Hard</button>
                    </div>
                </div>

                <!-- Number of Questions -->
                <div class="menu-section">
                    <h3>Number of Questions</h3>
                    <div class="options-grid">
                        <button class="option-btn" data-questions="5">5 Questions</button>
                        <button class="option-btn active" data-questions="10">10 Questions</button>
                        <button class="option-btn" data-questions="15">15 Questions</button>
                    </div>
                </div>

                <!-- Buzzer Mode Timer -->
                <div id="buzzer-timer-section" class="menu-section">
                    <h3>Buzzer Mode: Answer Time</h3>
                    <div class="options-grid">
                        <button class="option-btn" data-buzzer-time="5">5 Seconds</button>
                        <button class="option-btn active" data-buzzer-time="10">10 Seconds</button>
                        <button class="option-btn" data-buzzer-time="15">15 Seconds</button>
                    </div>
                </div>

                <!-- All Answer Mode Timer -->
                <div id="all-answer-timer-section" class="menu-section hidden">
                    <h3>All Answer Mode: Time Limit</h3>
                    <div class="options-grid">
                        <button class="option-btn" data-all-answer-time="10">10 Seconds</button>
                        <button class="option-btn active" data-all-answer-time="15">15 Seconds</button>
                        <button class="option-btn" data-all-answer-time="20">20 Seconds</button>
                    </div>
                </div>

                <!-- Start Button -->
                <button id="start-btn" class="start-btn" disabled>
                    Waiting for controllers...
                </button>

                <!-- Keyboard Mode Button -->
                <button id="keyboard-mode-btn" class="keyboard-mode-btn">
                    Play with Keyboard (Testing)
                </button>

                <!-- WebHID Panel -->
                <div class="webhid-panel hidden">
                    <button id="connect-webhid-btn" class="toggle-debug-btn">
                        üîå Connect WebHID Devices (For LED Control)
                    </button>
                    <div id="webhid-info" class="debug-info hidden">
                        <h3>WebHID Device Information</h3>
                        <div id="webhid-status"></div>
                        <div id="webhid-output"></div>

                        <div style="margin-top: 15px; padding: 15px; background: #37474f; border-radius: 8px;">
                            <h4 style="color: #81c784; margin-top: 0;">LED Test Controls</h4>
                            <p style="color: #b0bec5; font-size: 0.9em; margin-bottom: 10px;">
                                Experiment with different HID report values to try controlling LEDs:
                            </p>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 15px;">
                                <button class="led-test-btn" data-player="0">Player 1 LED</button>
                                <button class="led-test-btn" data-player="1">Player 2 LED</button>
                                <button class="led-test-btn" data-player="2">Player 3 LED</button>
                                <button class="led-test-btn" data-player="3">Player 4 LED</button>
                            </div>
                            <button id="led-all-off-btn" class="led-test-btn" style="width: 100%; background: #f44336;">
                                Turn All LEDs Off
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Debug Panel -->
                <div class="debug-panel hidden">
                    <button id="toggle-debug-btn" class="toggle-debug-btn">
                        üîß Show Controller Debug Info
                    </button>
                    <div id="debug-info" class="debug-info hidden">
                        <h3>Controller Debug Information</h3>
                        <div id="debug-output"></div>
                    </div>
                </div>

                <!-- High Scores -->
                <div id="high-scores" class="high-scores hidden">
                    <h3>üèÜ Recent High Scores</h3>
                    <div id="scores-list"></div>
                </div>
            </div>

            <!-- Game Screen -->
            <div id="game-screen" class="hidden">
                <!-- Player Panels -->
                <div class="player-panels" id="player-panels">
                    <!-- Player panels generated by JavaScript -->
                </div>

                <!-- Question Number & Timer -->
                <div class="question-header">
                    <div class="question-number">Question <span id="question-num">1</span>/<span id="total-questions">10</span></div>
                    <div class="timer-bar-container" id="timer-container">
                        <div class="timer-bar" id="timer-bar"></div>
                        <div class="timer-text" id="timer-text">10s</div>
                    </div>
                </div>

                <!-- Question Display -->
                <div class="question-section">
                    <div class="question-text" id="question-text">Loading question...</div>
                </div>

                <!-- Answer Options -->
                <div class="answers-section">
                    <div class="answer-option" data-index="0">
                        <span class="answer-letter">A</span>
                        <span class="answer-text" id="answer-0">Answer A</span>
                    </div>
                    <div class="answer-option" data-index="1">
                        <span class="answer-letter">B</span>
                        <span class="answer-text" id="answer-1">Answer B</span>
                    </div>
                    <div class="answer-option" data-index="2">
                        <span class="answer-letter">C</span>
                        <span class="answer-text" id="answer-2">Answer C</span>
                    </div>
                    <div class="answer-option" data-index="3">
                        <span class="answer-letter">D</span>
                        <span class="answer-text" id="answer-3">Answer D</span>
                    </div>
                </div>

                <!-- Game Status Message -->
                <div class="game-status" id="game-status"></div>

                <!-- End Game Early Button -->
                <button id="end-game-btn" class="end-game-btn">End Game Early</button>
            </div>

            <!-- Results Screen -->
            <div id="results-screen" class="hidden">
                <h2>üèÜ Game Over!</h2>

                <div class="results-podium" id="results-podium">
                    <!-- Results generated by JavaScript -->
                </div>

                <div class="results-stats" id="results-stats">
                    <!-- Stats generated by JavaScript -->
                </div>

                <button id="play-again-btn" class="start-btn">Play Again</button>
            </div>

            <a href="../../" class="back-link" style="display: block; text-align: center; margin-top: 30px;">‚Üê Back to Games</a>
        </div>

        <script src="game.js"></script>
    </body>
</html>
